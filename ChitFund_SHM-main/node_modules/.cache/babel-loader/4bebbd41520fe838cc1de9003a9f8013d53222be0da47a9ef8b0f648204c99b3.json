{"ast":null,"code":"import { ethers } from 'ethers';\nimport { getProvider, getSigner } from './provider.js';\nimport { ADDRESSES } from './config.js';\nimport ChitFundFactoryAbi from '../abis/ChitFundFactory.json';\nimport ChitGroupAbi from '../abis/ChitGroup.json';\nfunction getContract(address, abi, signerOrProvider) {\n  return new ethers.Contract(address, abi, signerOrProvider);\n}\nexport function getFactory(readonly = true) {\n  const p = readonly ? getProvider() : undefined;\n  const signerOrProvider = readonly ? p : undefined;\n  return getContract(ADDRESSES.ChitFundFactory, ChitFundFactoryAbi, signerOrProvider !== null && signerOrProvider !== void 0 ? signerOrProvider : p);\n}\nexport function getGroup(address, readonly = true) {\n  const provider = getProvider();\n  return getContract(address, ChitGroupAbi, provider);\n}\nexport async function createGroup(cfg) {\n  const signer = await getSigner();\n  const factory = new ethers.Contract(ADDRESSES.ChitFundFactory, ChitFundFactoryAbi, signer);\n  const tx = await factory.createChitGroup(cfg);\n  const receipt = await tx.wait();\n  const ev = receipt.logs.map(l => {\n    try {\n      return factory.interface.parseLog(l);\n    } catch {\n      return null;\n    }\n  }).find(e => e && e.name === 'GroupCreated');\n  return ev ? ev.args.group : null;\n}\nexport async function listGroups() {\n  const factory = getFactory(true);\n  return await factory.getActiveGroups();\n}\nexport async function joinGroup(groupAddress, valueWei = '0') {\n  const signer = await getSigner();\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\n  const tx = await group.joinGroup({\n    value: valueWei\n  });\n  return await tx.wait();\n}\nexport async function commitBid(groupAddress, amount, saltHex) {\n  const signer = await getSigner();\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\n  const hash = ethers.keccak256(ethers.AbiCoder.defaultAbiCoder().encode(['uint256', 'bytes32'], [amount, saltHex]));\n  const tx = await group.commitBid(hash);\n  return await tx.wait();\n}\nexport async function revealBid(groupAddress, amount, saltHex) {\n  const signer = await getSigner();\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\n  const tx = await group.revealBid(amount, saltHex);\n  return await tx.wait();\n}\nexport async function contribute(groupAddress, amountWei, isNative = true) {\n  const signer = await getSigner();\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\n  const overrides = isNative ? {\n    value: amountWei\n  } : {};\n  const tx = await group.makeContribution(amountWei, overrides);\n  return await tx.wait();\n}","map":{"version":3,"names":["ethers","getProvider","getSigner","ADDRESSES","ChitFundFactoryAbi","ChitGroupAbi","getContract","address","abi","signerOrProvider","Contract","getFactory","readonly","p","undefined","ChitFundFactory","getGroup","provider","createGroup","cfg","signer","factory","tx","createChitGroup","receipt","wait","ev","logs","map","l","interface","parseLog","find","e","name","args","group","listGroups","getActiveGroups","joinGroup","groupAddress","valueWei","value","commitBid","amount","saltHex","hash","keccak256","AbiCoder","defaultAbiCoder","encode","revealBid","contribute","amountWei","isNative","overrides","makeContribution"],"sources":["C:/Users/kjalf/Downloads/ChitFund_SHM-main/ChitFund_SHM-main/src/web3/contracts.js"],"sourcesContent":["import { ethers } from 'ethers';\r\nimport { getProvider, getSigner } from './provider.js';\r\nimport { ADDRESSES } from './config.js';\r\nimport ChitFundFactoryAbi from '../abis/ChitFundFactory.json';\r\nimport ChitGroupAbi from '../abis/ChitGroup.json';\r\n\r\nfunction getContract(address, abi, signerOrProvider) {\r\n  return new ethers.Contract(address, abi, signerOrProvider);\r\n}\r\n\r\nexport function getFactory(readonly = true) {\r\n  const p = readonly ? getProvider() : undefined;\r\n  const signerOrProvider = readonly ? p : undefined;\r\n  return getContract(ADDRESSES.ChitFundFactory, ChitFundFactoryAbi, signerOrProvider ?? p);\r\n}\r\n\r\nexport function getGroup(address, readonly = true) {\r\n  const provider = getProvider();\r\n  return getContract(address, ChitGroupAbi, provider);\r\n}\r\n\r\nexport async function createGroup(cfg) {\r\n  const signer = await getSigner();\r\n  const factory = new ethers.Contract(ADDRESSES.ChitFundFactory, ChitFundFactoryAbi, signer);\r\n  const tx = await factory.createChitGroup(cfg);\r\n  const receipt = await tx.wait();\r\n  const ev = receipt.logs\r\n    .map(l => {\r\n      try { return factory.interface.parseLog(l); } catch { return null; }\r\n    })\r\n    .find(e => e && e.name === 'GroupCreated');\r\n  return ev ? ev.args.group : null;\r\n}\r\n\r\nexport async function listGroups() {\r\n  const factory = getFactory(true);\r\n  return await factory.getActiveGroups();\r\n}\r\n\r\nexport async function joinGroup(groupAddress, valueWei = '0') {\r\n  const signer = await getSigner();\r\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\r\n  const tx = await group.joinGroup({ value: valueWei });\r\n  return await tx.wait();\r\n}\r\n\r\nexport async function commitBid(groupAddress, amount, saltHex) {\r\n  const signer = await getSigner();\r\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\r\n  const hash = ethers.keccak256(ethers.AbiCoder.defaultAbiCoder().encode(['uint256','bytes32'], [amount, saltHex]));\r\n  const tx = await group.commitBid(hash);\r\n  return await tx.wait();\r\n}\r\n\r\nexport async function revealBid(groupAddress, amount, saltHex) {\r\n  const signer = await getSigner();\r\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\r\n  const tx = await group.revealBid(amount, saltHex);\r\n  return await tx.wait();\r\n}\r\n\r\nexport async function contribute(groupAddress, amountWei, isNative = true) {\r\n  const signer = await getSigner();\r\n  const group = new ethers.Contract(groupAddress, ChitGroupAbi, signer);\r\n  const overrides = isNative ? { value: amountWei } : {};\r\n  const tx = await group.makeContribution(amountWei, overrides);\r\n  return await tx.wait();\r\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}