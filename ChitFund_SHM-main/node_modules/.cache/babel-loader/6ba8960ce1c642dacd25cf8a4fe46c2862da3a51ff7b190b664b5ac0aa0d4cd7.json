{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kjalf\\\\Downloads\\\\ChitFund_SHM-main\\\\ChitFund_SHM-main\\\\src\\\\components\\\\BiddingInterface.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { listGroups, getGroup, readGroupBasics, commitBid, revealBid, computeCommitHash } from '../web3/contracts.js';\nimport { getProvider } from '../web3/provider.js';\nimport { ethers } from 'ethers';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst BiddingInterface = () => {\n  _s();\n  const [groups, setGroups] = useState([]);\n  const [selectedGroup, setSelectedGroup] = useState('');\n  const [basics, setBasics] = useState(null); // { cfg, currentCycle, phase }\n  const [commitAmount, setCommitAmount] = useState('');\n  const [saltHex, setSaltHex] = useState('');\n  const [commitHash, setCommitHash] = useState('');\n  const [revealAmount, setRevealAmount] = useState('');\n  const [revealSalt, setRevealSalt] = useState('');\n  const [status, setStatus] = useState('');\n  const [error, setError] = useState('');\n  const [nowSec, setNowSec] = useState(Math.floor(Date.now() / 1000));\n\n  // Live bidding state\n  const [biddingAddress, setBiddingAddress] = useState('');\n  const [winner, setWinner] = useState('');\n  const [winningAmount, setWinningAmount] = useState('');\n  const [reveals, setReveals] = useState([]); // { bidder, amount, at }\n\n  // Local persistent history per (group, cycle)\n  const historyKey = useMemo(() => {\n    var _basics$currentCycle;\n    if (!selectedGroup) return '';\n    const cycle = (_basics$currentCycle = basics === null || basics === void 0 ? void 0 : basics.currentCycle) !== null && _basics$currentCycle !== void 0 ? _basics$currentCycle : 0;\n    return `bidding_history_${selectedGroup}_${cycle}`;\n  }, [selectedGroup, basics]);\n  const loadHistory = () => {\n    try {\n      if (!historyKey) return [];\n      const raw = localStorage.getItem(historyKey);\n      const parsed = raw ? JSON.parse(raw) : [];\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  };\n  const saveHistory = items => {\n    try {\n      if (historyKey) localStorage.setItem(historyKey, JSON.stringify(items));\n    } catch {}\n  };\n  const sortByAmountDesc = items => items.slice().sort((a, b) => parseInt(b.amount || 0, 10) - parseInt(a.amount || 0, 10));\n\n  // Remove time-sequenced demo bids so they don't appear pre-selection\n  const sanitizeInitial = items => items.filter(e => !['35', '33', '32'].includes(String(e === null || e === void 0 ? void 0 : e.amount)));\n  const seedDummyHistory = () => {\n    const base = Date.now();\n    const mk = (user, amount, offsetMin) => ({\n      bidder: user,\n      amount: String(parseInt(amount, 10)),\n      at: base - offsetMin * 60 * 1000\n    });\n    const samples = sortByAmountDesc([mk('User001', 50, 15), mk('User002', 47, 13), mk('User003', 41, 11)]);\n    saveHistory(samples);\n    return samples;\n  };\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      try {\n        const addrs = await listGroups();\n        if (mounted) setGroups(addrs);\n      } catch (e) {\n        setError((e === null || e === void 0 ? void 0 : e.message) || 'Failed to load groups');\n      }\n    }\n    load();\n    const t = setInterval(() => setNowSec(Math.floor(Date.now() / 1000)), 1000);\n    return () => {\n      mounted = false;\n      clearInterval(t);\n    };\n  }, []);\n  useEffect(() => {\n    let mounted = true;\n    async function fetchBasics() {\n      if (!selectedGroup) {\n        setBasics(null);\n        return;\n      }\n      try {\n        const b = await readGroupBasics(selectedGroup);\n        if (mounted) setBasics(b);\n      } catch (e) {\n        setError((e === null || e === void 0 ? void 0 : e.message) || 'Failed to read group basics');\n        setBasics(null);\n      }\n    }\n    fetchBasics();\n    const t = setInterval(fetchBasics, 10000);\n    return () => {\n      mounted = false;\n      clearInterval(t);\n    };\n  }, [selectedGroup]);\n  useEffect(() => {\n    if (!commitAmount || !saltHex) {\n      setCommitHash('');\n      return;\n    }\n    try {\n      const hash = computeCommitHash(commitAmount, saltHex);\n      setCommitHash(hash);\n    } catch {\n      setCommitHash('');\n    }\n  }, [commitAmount, saltHex]);\n  const generateSalt = () => {\n    const bytes = ethers.randomBytes(32);\n    const hex = ethers.hexlify(bytes);\n    setSaltHex(hex);\n    setRevealSalt(hex);\n  };\n  const phaseLabel = p => p === 0 ? 'Commit' : p === 1 ? 'Reveal' : p === 2 ? 'Finalized' : 'Unknown';\n  const computeWindows = () => {\n    if (!basics) return null;\n    const cfg = basics.cfg;\n    const cycleStart = Number(cfg.startTime) + basics.currentCycle * Number(cfg.periodDuration);\n    const commitEnd = cycleStart + Number(cfg.biddingCommitDuration);\n    const revealEnd = commitEnd + Number(cfg.biddingRevealDuration);\n    return {\n      cycleStart,\n      commitEnd,\n      revealEnd\n    };\n  };\n  const handleCommit = async () => {\n    if (!selectedGroup) return;\n    try {\n      setStatus('Submitting commit...');\n      setError('');\n      await commitBid(selectedGroup, commitAmount, saltHex);\n      setStatus('Commit submitted');\n    } catch (e) {\n      setError((e === null || e === void 0 ? void 0 : e.shortMessage) || (e === null || e === void 0 ? void 0 : e.message) || 'Commit failed');\n      setStatus('');\n    }\n  };\n  const handleReveal = async () => {\n    if (!selectedGroup) return;\n    try {\n      setStatus('Submitting reveal...');\n      setError('');\n      await revealBid(selectedGroup, revealAmount, revealSalt);\n      setStatus('Reveal submitted');\n    } catch (e) {\n      setError((e === null || e === void 0 ? void 0 : e.shortMessage) || (e === null || e === void 0 ? void 0 : e.message) || 'Reveal failed');\n      setStatus('');\n    }\n  };\n\n  // Discover and subscribe to the cycle's bidding contract\n  useEffect(() => {\n    let unsub = () => {};\n    async function wire() {\n      try {\n        setBiddingAddress('');\n        setWinner('');\n        setWinningAmount('');\n        setReveals([]);\n        if (!selectedGroup || !basics) return;\n        const group = getGroup(selectedGroup, true);\n        const addr = await group.cycleBidding(basics.currentCycle);\n        if (addr && ethers.isAddress(addr) && addr !== ethers.ZeroAddress) {\n          setBiddingAddress(addr);\n          const provider = getProvider();\n          const bsAbi = ['event BidCommitted(address indexed bidder)', 'event BidRevealed(address indexed bidder, uint256 amount)', 'event WinnerSelected(address indexed winner, uint256 amount)', 'function winner() view returns (address)', 'function winningAmount() view returns (uint256)'];\n          const bs = new ethers.Contract(addr, bsAbi, provider);\n          // Load current state\n          try {\n            const w = await bs.winner();\n            const wa = await bs.winningAmount();\n            setWinner(w);\n            setWinningAmount(wa.toString());\n          } catch {}\n\n          // Initialize history from storage\n          {\n            const existingRaw = loadHistory();\n            const existing = sortByAmountDesc(sanitizeInitial(existingRaw));\n            if (existing.length === 0) {\n              const seeded = seedDummyHistory();\n              setReveals(seeded);\n              saveHistory(seeded);\n            } else {\n              setReveals(existing);\n              saveHistory(existing);\n            }\n          }\n          // Subscribe to events\n          const onReveal = (bidder, amount) => {\n            setReveals(prev => {\n              const next = [{\n                bidder,\n                amount: amount.toString(),\n                at: Date.now()\n              }, ...prev].slice(0, 200);\n              saveHistory(next);\n              return next;\n            });\n            // optimistic update\n            try {\n              setWinningAmount(cur => {\n                const curBn = cur ? ethers.toBigInt(cur) : undefined;\n                const amt = ethers.toBigInt(amount);\n                if (!winner || curBn !== undefined && amt < curBn) {\n                  setWinner(bidder);\n                  return amt.toString();\n                }\n                return cur;\n              });\n            } catch {}\n          };\n          const onWinner = (w, amt) => {\n            setWinner(w);\n            setWinningAmount(amt.toString());\n          };\n          bs.on('BidRevealed', onReveal);\n          bs.on('WinnerSelected', onWinner);\n          unsub = () => {\n            bs.off('BidRevealed', onReveal);\n            bs.off('WinnerSelected', onWinner);\n          };\n        }\n      } catch (e) {\n        // ignore wiring errors\n      }\n    }\n    wire();\n    return () => {\n      try {\n        unsub();\n      } catch {}\n    };\n  }, [selectedGroup, basics]);\n\n  // Keep history in sync if storage changes (multi-tab/demo updates)\n  useEffect(() => {\n    var _cleaned$, _cleaned$2, _cleaned$3;\n    if (!historyKey) return;\n    const onStorage = e => {\n      if (e.key === historyKey) setReveals(loadHistory());\n    };\n    window.addEventListener('storage', onStorage);\n    // Seed if empty on selection\n    const existingRaw = loadHistory();\n    const cleaned = sanitizeInitial(existingRaw);\n    const needsSeed = cleaned.length === 0 || ((_cleaned$ = cleaned[0]) === null || _cleaned$ === void 0 ? void 0 : _cleaned$.amount) !== '50' || ((_cleaned$2 = cleaned[1]) === null || _cleaned$2 === void 0 ? void 0 : _cleaned$2.amount) !== '47' || ((_cleaned$3 = cleaned[2]) === null || _cleaned$3 === void 0 ? void 0 : _cleaned$3.amount) !== '41';\n    if (needsSeed) {\n      const seeded = seedDummyHistory();\n      setReveals(seeded);\n      saveHistory(seeded);\n    } else {\n      setReveals(cleaned);\n      saveHistory(cleaned);\n    }\n    const t = setInterval(() => setReveals(loadHistory()), 2000);\n    return () => {\n      window.removeEventListener('storage', onStorage);\n      clearInterval(t);\n    };\n  }, [historyKey]);\n  const formatTokens = val => String(parseInt(val, 10));\n  const shortAddr = a => a && a.length > 10 ? `${a.slice(0, 6)}…${a.slice(-4)}` : a || '-';\n\n  // Schedule demo bids after selecting a group\n  const delayedTimerRef = useRef(null); // 35 tokens at 10s\n  const delayedTimerRef2 = useRef(null); // 33 tokens at 15s\n  const delayedTimerRef3 = useRef(null); // your bid at 22s\n  const delayedTimerRef4 = useRef(null); // mark win at 30s\n  useEffect(() => {\n    if (delayedTimerRef.current) {\n      clearTimeout(delayedTimerRef.current);\n      delayedTimerRef.current = null;\n    }\n    if (delayedTimerRef2.current) {\n      clearTimeout(delayedTimerRef2.current);\n      delayedTimerRef2.current = null;\n    }\n    if (delayedTimerRef3.current) {\n      clearTimeout(delayedTimerRef3.current);\n      delayedTimerRef3.current = null;\n    }\n    if (delayedTimerRef4.current) {\n      clearTimeout(delayedTimerRef4.current);\n      delayedTimerRef4.current = null;\n    }\n    if (!selectedGroup) return;\n    delayedTimerRef.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has35 = existing.some(e => String(e === null || e === void 0 ? void 0 : e.amount) === '35');\n        if (!has35) {\n          const entry = {\n            bidder: 'You',\n            amount: '35',\n            at: Date.now()\n          };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 10000);\n    delayedTimerRef2.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has33 = existing.some(e => String(e === null || e === void 0 ? void 0 : e.amount) === '33');\n        if (!has33) {\n          const entry = {\n            bidder: 'User004',\n            amount: '33',\n            at: Date.now()\n          };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 15000);\n    delayedTimerRef3.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has32 = existing.some(e => String(e === null || e === void 0 ? void 0 : e.amount) === '32');\n        if (!has32) {\n          const entry = {\n            bidder: 'You',\n            amount: '32',\n            at: Date.now()\n          };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 22000);\n    delayedTimerRef4.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        // mark the smallest 'You' bid (32) as won\n        const next = existing.map(e => {\n          if (String(e.amount) === '32' && String(e.bidder) === 'You') {\n            return {\n              ...e,\n              won: true\n            };\n          }\n          return e;\n        });\n        saveHistory(next);\n        setReveals(next);\n      } catch {}\n    }, 30000);\n    return () => {\n      if (delayedTimerRef.current) {\n        clearTimeout(delayedTimerRef.current);\n        delayedTimerRef.current = null;\n      }\n      if (delayedTimerRef2.current) {\n        clearTimeout(delayedTimerRef2.current);\n        delayedTimerRef2.current = null;\n      }\n      if (delayedTimerRef3.current) {\n        clearTimeout(delayedTimerRef3.current);\n        delayedTimerRef3.current = null;\n      }\n      if (delayedTimerRef4.current) {\n        clearTimeout(delayedTimerRef4.current);\n        delayedTimerRef4.current = null;\n      }\n    };\n  }, [selectedGroup, historyKey]);\n  const windows = computeWindows();\n  const now = nowSec;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"dashboard\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dashboard-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Bidding Interface\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Commit and reveal your bids for the current cycle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid',\n        gridTemplateColumns: '1fr 360px',\n        gap: '24px',\n        alignItems: 'start'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"component-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-header\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Select Group\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-body\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                gap: '10px',\n                alignItems: 'center',\n                flexWrap: 'wrap'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"select\", {\n                className: \"form-input\",\n                value: selectedGroup,\n                onChange: e => setSelectedGroup(e.target.value),\n                style: {\n                  minWidth: '360px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"-- Select a group address --\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 15\n                }, this), groups.map(addr => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: addr,\n                  children: addr\n                }, addr, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 17\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 13\n              }, this), basics && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: 'flex',\n                  gap: '15px',\n                  color: '#718096'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Cycle: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: basics.currentCycle\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 342,\n                    columnNumber: 30\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 342,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [\"Phase: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: phaseLabel(basics.phase)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 343,\n                    columnNumber: 30\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 17\n                }, this), windows && /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [\"Commit ends: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: new Date(windows.commitEnd * 1000).toLocaleString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 346,\n                      columnNumber: 40\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 346,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [\"Reveal ends: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: new Date(windows.revealEnd * 1000).toLocaleString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 347,\n                      columnNumber: 40\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 347,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: [\"Now: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: new Date(now * 1000).toLocaleTimeString()\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 348,\n                      columnNumber: 32\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 7\n        }, this), biddingAddress && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"component-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-header\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Live Bidding Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-body\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: '1fr 1fr',\n                gap: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: '12px',\n                    color: '#718096'\n                  },\n                  children: \"Bidding Contract\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontWeight: '600'\n                  },\n                  children: biddingAddress\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 367,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: '12px',\n                    color: '#718096'\n                  },\n                  children: \"Current Winner\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontWeight: '600'\n                  },\n                  children: winner || '-'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 371,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontSize: '12px',\n                    color: '#718096'\n                  },\n                  children: \"Winning Amount\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    fontWeight: '600'\n                  },\n                  children: winningAmount || '-'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 373,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 363,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 359,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"component-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-header\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Commit Bid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-body\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: '1fr 1fr',\n                gap: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Amount (uint256)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 388,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-input\",\n                  type: \"number\",\n                  value: commitAmount,\n                  onChange: e => setCommitAmount(e.target.value),\n                  placeholder: \"e.g. 100\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 389,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Salt (bytes32 hex)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 392,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    display: 'flex',\n                    gap: '8px'\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"form-input\",\n                    type: \"text\",\n                    value: saltHex,\n                    onChange: e => setSaltHex(e.target.value),\n                    placeholder: \"0x...32 bytes\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 394,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"btn btn-secondary\",\n                    onClick: generateSalt,\n                    children: \"Random\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 395,\n                    columnNumber: 17\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 13\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 386,\n              columnNumber: 11\n            }, this), commitHash && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '10px',\n                color: '#718096'\n              },\n              children: [\"Commit hash: \", /*#__PURE__*/_jsxDEV(\"code\", {\n                children: commitHash\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 79\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '12px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-primary\",\n                onClick: handleCommit,\n                disabled: !selectedGroup || !commitAmount || !saltHex,\n                children: \"Submit Commit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 11\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"component-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-header\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Reveal Bid\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-body\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gridTemplateColumns: '1fr 1fr',\n                gap: '16px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Amount (uint256)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-input\",\n                  type: \"number\",\n                  value: revealAmount,\n                  onChange: e => setRevealAmount(e.target.value),\n                  placeholder: \"Must match commit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 417,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  className: \"form-label\",\n                  children: \"Salt (bytes32 hex)\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 420,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  className: \"form-input\",\n                  type: \"text\",\n                  value: revealSalt,\n                  onChange: e => setRevealSalt(e.target.value),\n                  placeholder: \"Must match commit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 13\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 414,\n              columnNumber: 11\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: '12px'\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-primary\",\n                onClick: handleReveal,\n                disabled: !selectedGroup || !revealAmount || !revealSalt,\n                children: \"Submit Reveal\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 11\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '10px'\n          },\n          children: [status && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#2f855a'\n            },\n            children: status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 20\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#c53030'\n            },\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"component-card\",\n          style: {\n            position: 'sticky',\n            top: '100px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-header\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              children: \"Bidding History\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"component-body\",\n            children: !selectedGroup ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#718096'\n              },\n              children: \"Select a group to view history.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 442,\n              columnNumber: 17\n            }, this) : reveals.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#718096'\n              },\n              children: \"No reveals yet.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 444,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'grid',\n                gap: '12px'\n              },\n              children: reveals.map((r, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  border: '1px solid #e2e8f0',\n                  borderRadius: '12px',\n                  padding: '16px',\n                  display: 'grid',\n                  gridTemplateColumns: '1fr auto',\n                  alignItems: 'center'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      fontWeight: 600,\n                      fontSize: '16px'\n                    },\n                    children: shortAddr(r.bidder)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 450,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: '#718096',\n                      fontSize: '14px'\n                    },\n                    children: r.at ? new Date(r.at).toLocaleTimeString() : ''\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 451,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 449,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    color: '#e53e3e',\n                    fontWeight: 700,\n                    fontSize: '20px'\n                  },\n                  children: [formatTokens(r.amount), \" tokens\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 453,\n                  columnNumber: 23\n                }, this)]\n              }, idx, true, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 435,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 321,\n    columnNumber: 5\n  }, this);\n};\n_s(BiddingInterface, \"ZsZw0Ceh6G3hBJLsgxagdh+5zt4=\");\n_c = BiddingInterface;\nexport default BiddingInterface;\nvar _c;\n$RefreshReg$(_c, \"BiddingInterface\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","useRef","listGroups","getGroup","readGroupBasics","commitBid","revealBid","computeCommitHash","getProvider","ethers","jsxDEV","_jsxDEV","Fragment","_Fragment","BiddingInterface","_s","groups","setGroups","selectedGroup","setSelectedGroup","basics","setBasics","commitAmount","setCommitAmount","saltHex","setSaltHex","commitHash","setCommitHash","revealAmount","setRevealAmount","revealSalt","setRevealSalt","status","setStatus","error","setError","nowSec","setNowSec","Math","floor","Date","now","biddingAddress","setBiddingAddress","winner","setWinner","winningAmount","setWinningAmount","reveals","setReveals","historyKey","_basics$currentCycle","cycle","currentCycle","loadHistory","raw","localStorage","getItem","parsed","JSON","parse","Array","isArray","saveHistory","items","setItem","stringify","sortByAmountDesc","slice","sort","a","b","parseInt","amount","sanitizeInitial","filter","e","includes","String","seedDummyHistory","base","mk","user","offsetMin","bidder","at","samples","mounted","load","addrs","message","t","setInterval","clearInterval","fetchBasics","hash","generateSalt","bytes","randomBytes","hex","hexlify","phaseLabel","p","computeWindows","cfg","cycleStart","Number","startTime","periodDuration","commitEnd","biddingCommitDuration","revealEnd","biddingRevealDuration","handleCommit","shortMessage","handleReveal","unsub","wire","group","addr","cycleBidding","isAddress","ZeroAddress","provider","bsAbi","bs","Contract","w","wa","toString","existingRaw","existing","length","seeded","onReveal","prev","next","cur","curBn","toBigInt","undefined","amt","onWinner","on","off","_cleaned$","_cleaned$2","_cleaned$3","onStorage","key","window","addEventListener","cleaned","needsSeed","removeEventListener","formatTokens","val","shortAddr","delayedTimerRef","delayedTimerRef2","delayedTimerRef3","delayedTimerRef4","current","clearTimeout","setTimeout","has35","some","entry","has33","has32","map","won","windows","className","children","fileName","_jsxFileName","lineNumber","columnNumber","style","display","gridTemplateColumns","gap","alignItems","flexWrap","value","onChange","target","minWidth","color","phase","toLocaleString","toLocaleTimeString","fontSize","fontWeight","type","placeholder","onClick","marginTop","disabled","position","top","r","idx","border","borderRadius","padding","_c","$RefreshReg$"],"sources":["C:/Users/kjalf/Downloads/ChitFund_SHM-main/ChitFund_SHM-main/src/components/BiddingInterface.js"],"sourcesContent":["import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { listGroups, getGroup, readGroupBasics, commitBid, revealBid, computeCommitHash } from '../web3/contracts.js';\nimport { getProvider } from '../web3/provider.js';\nimport { ethers } from 'ethers';\n\nconst BiddingInterface = () => {\n  const [groups, setGroups] = useState([]);\n  const [selectedGroup, setSelectedGroup] = useState('');\n  const [basics, setBasics] = useState(null); // { cfg, currentCycle, phase }\n  const [commitAmount, setCommitAmount] = useState('');\n  const [saltHex, setSaltHex] = useState('');\n  const [commitHash, setCommitHash] = useState('');\n  const [revealAmount, setRevealAmount] = useState('');\n  const [revealSalt, setRevealSalt] = useState('');\n  const [status, setStatus] = useState('');\n  const [error, setError] = useState('');\n  const [nowSec, setNowSec] = useState(Math.floor(Date.now() / 1000));\n\n  // Live bidding state\n  const [biddingAddress, setBiddingAddress] = useState('');\n  const [winner, setWinner] = useState('');\n  const [winningAmount, setWinningAmount] = useState('');\n  const [reveals, setReveals] = useState([]); // { bidder, amount, at }\n\n  // Local persistent history per (group, cycle)\n  const historyKey = useMemo(() => {\n    if (!selectedGroup) return '';\n    const cycle = basics?.currentCycle ?? 0;\n    return `bidding_history_${selectedGroup}_${cycle}`;\n  }, [selectedGroup, basics]);\n\n  const loadHistory = () => {\n    try {\n      if (!historyKey) return [];\n      const raw = localStorage.getItem(historyKey);\n      const parsed = raw ? JSON.parse(raw) : [];\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const saveHistory = (items) => {\n    try { if (historyKey) localStorage.setItem(historyKey, JSON.stringify(items)); } catch {}\n  };\n\n  const sortByAmountDesc = (items) =>\n    items.slice().sort((a, b) => parseInt(b.amount || 0, 10) - parseInt(a.amount || 0, 10));\n\n  // Remove time-sequenced demo bids so they don't appear pre-selection\n  const sanitizeInitial = (items) => items.filter(e => !['35','33','32'].includes(String(e?.amount)));\n\n  const seedDummyHistory = () => {\n    const base = Date.now();\n    const mk = (user, amount, offsetMin) => ({ bidder: user, amount: String(parseInt(amount, 10)), at: base - offsetMin * 60 * 1000 });\n    const samples = sortByAmountDesc([\n      mk('User001', 50, 15),\n      mk('User002', 47, 13),\n      mk('User003', 41, 11),\n    ]);\n    saveHistory(samples);\n    return samples;\n  };\n\n  useEffect(() => {\n    let mounted = true;\n    async function load() {\n      try {\n        const addrs = await listGroups();\n        if (mounted) setGroups(addrs);\n      } catch (e) {\n        setError(e?.message || 'Failed to load groups');\n      }\n    }\n    load();\n    const t = setInterval(() => setNowSec(Math.floor(Date.now() / 1000)), 1000);\n    return () => { mounted = false; clearInterval(t); };\n  }, []);\n\n  useEffect(() => {\n    let mounted = true;\n    async function fetchBasics() {\n      if (!selectedGroup) { setBasics(null); return; }\n      try {\n        const b = await readGroupBasics(selectedGroup);\n        if (mounted) setBasics(b);\n      } catch (e) {\n        setError(e?.message || 'Failed to read group basics');\n        setBasics(null);\n      }\n    }\n    fetchBasics();\n    const t = setInterval(fetchBasics, 10_000);\n    return () => { mounted = false; clearInterval(t); };\n  }, [selectedGroup]);\n\n  useEffect(() => {\n    if (!commitAmount || !saltHex) { setCommitHash(''); return; }\n    try {\n      const hash = computeCommitHash(commitAmount, saltHex);\n      setCommitHash(hash);\n    } catch { setCommitHash(''); }\n  }, [commitAmount, saltHex]);\n\n  const generateSalt = () => {\n    const bytes = ethers.randomBytes(32);\n    const hex = ethers.hexlify(bytes);\n    setSaltHex(hex);\n    setRevealSalt(hex);\n  };\n\n  const phaseLabel = (p) => p === 0 ? 'Commit' : p === 1 ? 'Reveal' : p === 2 ? 'Finalized' : 'Unknown';\n\n  const computeWindows = () => {\n    if (!basics) return null;\n    const cfg = basics.cfg;\n    const cycleStart = Number(cfg.startTime) + basics.currentCycle * Number(cfg.periodDuration);\n    const commitEnd = cycleStart + Number(cfg.biddingCommitDuration);\n    const revealEnd = commitEnd + Number(cfg.biddingRevealDuration);\n    return { cycleStart, commitEnd, revealEnd };\n  };\n\n  const handleCommit = async () => {\n    if (!selectedGroup) return;\n    try {\n      setStatus('Submitting commit...'); setError('');\n      await commitBid(selectedGroup, commitAmount, saltHex);\n      setStatus('Commit submitted');\n    } catch (e) {\n      setError(e?.shortMessage || e?.message || 'Commit failed'); setStatus('');\n    }\n  };\n\n  const handleReveal = async () => {\n    if (!selectedGroup) return;\n    try {\n      setStatus('Submitting reveal...'); setError('');\n      await revealBid(selectedGroup, revealAmount, revealSalt);\n      setStatus('Reveal submitted');\n    } catch (e) {\n      setError(e?.shortMessage || e?.message || 'Reveal failed'); setStatus('');\n    }\n  };\n\n  // Discover and subscribe to the cycle's bidding contract\n  useEffect(() => {\n    let unsub = () => {};\n    async function wire() {\n      try {\n        setBiddingAddress(''); setWinner(''); setWinningAmount(''); setReveals([]);\n        if (!selectedGroup || !basics) return;\n        const group = getGroup(selectedGroup, true);\n        const addr = await group.cycleBidding(basics.currentCycle);\n        if (addr && ethers.isAddress(addr) && addr !== ethers.ZeroAddress) {\n          setBiddingAddress(addr);\n          const provider = getProvider();\n          const bsAbi = [\n            'event BidCommitted(address indexed bidder)',\n            'event BidRevealed(address indexed bidder, uint256 amount)',\n            'event WinnerSelected(address indexed winner, uint256 amount)',\n            'function winner() view returns (address)',\n            'function winningAmount() view returns (uint256)'\n          ];\n          const bs = new ethers.Contract(addr, bsAbi, provider);\n          // Load current state\n          try {\n            const w = await bs.winner();\n            const wa = await bs.winningAmount();\n            setWinner(w);\n            setWinningAmount(wa.toString());\n          } catch {}\n\n          // Initialize history from storage\n          {\n            const existingRaw = loadHistory();\n            const existing = sortByAmountDesc(sanitizeInitial(existingRaw));\n            if (existing.length === 0) {\n              const seeded = seedDummyHistory();\n              setReveals(seeded);\n              saveHistory(seeded);\n            } else {\n              setReveals(existing);\n              saveHistory(existing);\n            }\n          }\n          // Subscribe to events\n          const onReveal = (bidder, amount) => {\n            setReveals(prev => {\n              const next = [{ bidder, amount: amount.toString(), at: Date.now() }, ...prev].slice(0, 200);\n              saveHistory(next);\n              return next;\n            });\n            // optimistic update\n            try { setWinningAmount((cur) => {\n              const curBn = cur ? ethers.toBigInt(cur) : undefined;\n              const amt = ethers.toBigInt(amount);\n              if (!winner || (curBn !== undefined && amt < curBn)) {\n                setWinner(bidder);\n                return amt.toString();\n              }\n              return cur;\n            }); } catch {}\n          };\n          const onWinner = (w, amt) => {\n            setWinner(w);\n            setWinningAmount(amt.toString());\n          };\n          bs.on('BidRevealed', onReveal);\n          bs.on('WinnerSelected', onWinner);\n          unsub = () => {\n            bs.off('BidRevealed', onReveal);\n            bs.off('WinnerSelected', onWinner);\n          };\n        }\n      } catch (e) {\n        // ignore wiring errors\n      }\n    }\n    wire();\n    return () => { try { unsub(); } catch {} };\n  }, [selectedGroup, basics]);\n\n  // Keep history in sync if storage changes (multi-tab/demo updates)\n  useEffect(() => {\n    if (!historyKey) return;\n    const onStorage = (e) => { if (e.key === historyKey) setReveals(loadHistory()); };\n    window.addEventListener('storage', onStorage);\n    // Seed if empty on selection\n    const existingRaw = loadHistory();\n    const cleaned = sanitizeInitial(existingRaw);\n    const needsSeed = cleaned.length === 0 || cleaned[0]?.amount !== '50' || cleaned[1]?.amount !== '47' || cleaned[2]?.amount !== '41';\n    if (needsSeed) {\n      const seeded = seedDummyHistory();\n      setReveals(seeded);\n      saveHistory(seeded);\n    } else {\n      setReveals(cleaned);\n      saveHistory(cleaned);\n    }\n    const t = setInterval(() => setReveals(loadHistory()), 2000);\n    return () => { window.removeEventListener('storage', onStorage); clearInterval(t); };\n  }, [historyKey]);\n\n  const formatTokens = (val) => String(parseInt(val, 10));\n\n  const shortAddr = (a) => a && a.length > 10 ? `${a.slice(0, 6)}…${a.slice(-4)}` : a || '-';\n\n  // Schedule demo bids after selecting a group\n  const delayedTimerRef = useRef(null); // 35 tokens at 10s\n  const delayedTimerRef2 = useRef(null); // 33 tokens at 15s\n  const delayedTimerRef3 = useRef(null); // your bid at 22s\n  const delayedTimerRef4 = useRef(null); // mark win at 30s\n  useEffect(() => {\n    if (delayedTimerRef.current) { clearTimeout(delayedTimerRef.current); delayedTimerRef.current = null; }\n    if (delayedTimerRef2.current) { clearTimeout(delayedTimerRef2.current); delayedTimerRef2.current = null; }\n    if (delayedTimerRef3.current) { clearTimeout(delayedTimerRef3.current); delayedTimerRef3.current = null; }\n    if (delayedTimerRef4.current) { clearTimeout(delayedTimerRef4.current); delayedTimerRef4.current = null; }\n    if (!selectedGroup) return;\n    delayedTimerRef.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has35 = existing.some(e => String(e?.amount) === '35');\n        if (!has35) {\n          const entry = { bidder: 'You', amount: '35', at: Date.now() };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 10_000);\n    delayedTimerRef2.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has33 = existing.some(e => String(e?.amount) === '33');\n        if (!has33) {\n          const entry = { bidder: 'User004', amount: '33', at: Date.now() };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 15_000);\n    delayedTimerRef3.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        const has32 = existing.some(e => String(e?.amount) === '32');\n        if (!has32) {\n          const entry = { bidder: 'You', amount: '32', at: Date.now() };\n          const next = sortByAmountDesc([entry, ...existing]).slice(0, 200);\n          saveHistory(next);\n          setReveals(next);\n        }\n      } catch {}\n    }, 22_000);\n    delayedTimerRef4.current = setTimeout(() => {\n      try {\n        const existing = loadHistory();\n        // mark the smallest 'You' bid (32) as won\n        const next = existing.map(e => {\n          if (String(e.amount) === '32' && String(e.bidder) === 'You') {\n            return { ...e, won: true };\n          }\n          return e;\n        });\n        saveHistory(next);\n        setReveals(next);\n      } catch {}\n    }, 30_000);\n    return () => { \n      if (delayedTimerRef.current) { clearTimeout(delayedTimerRef.current); delayedTimerRef.current = null; }\n      if (delayedTimerRef2.current) { clearTimeout(delayedTimerRef2.current); delayedTimerRef2.current = null; }\n      if (delayedTimerRef3.current) { clearTimeout(delayedTimerRef3.current); delayedTimerRef3.current = null; }\n      if (delayedTimerRef4.current) { clearTimeout(delayedTimerRef4.current); delayedTimerRef4.current = null; }\n    };\n  }, [selectedGroup, historyKey]);\n\n  const windows = computeWindows();\n  const now = nowSec;\n\n  return (\n    <div className=\"dashboard\">\n      <div className=\"dashboard-header\">\n        <h1>Bidding Interface</h1>\n        <p>Commit and reveal your bids for the current cycle</p>\n      </div>\n      <div style={{ display: 'grid', gridTemplateColumns: '1fr 360px', gap: '24px', alignItems: 'start' }}>\n        <div>\n      <div className=\"component-card\">\n        <div className=\"component-header\">\n          <h2>Select Group</h2>\n        </div>\n        <div className=\"component-body\">\n          <div style={{ display: 'flex', gap: '10px', alignItems: 'center', flexWrap: 'wrap' }}>\n            <select className=\"form-input\" value={selectedGroup} onChange={(e) => setSelectedGroup(e.target.value)} style={{ minWidth: '360px' }}>\n              <option value=\"\">-- Select a group address --</option>\n              {groups.map(addr => (\n                <option key={addr} value={addr}>{addr}</option>\n              ))}\n            </select>\n            {basics && (\n              <div style={{ display: 'flex', gap: '15px', color: '#718096' }}>\n                <span>Cycle: <strong>{basics.currentCycle}</strong></span>\n                <span>Phase: <strong>{phaseLabel(basics.phase)}</strong></span>\n                {windows && (\n                  <>\n                    <span>Commit ends: <strong>{new Date(windows.commitEnd * 1000).toLocaleString()}</strong></span>\n                    <span>Reveal ends: <strong>{new Date(windows.revealEnd * 1000).toLocaleString()}</strong></span>\n                    <span>Now: <strong>{new Date(now * 1000).toLocaleTimeString()}</strong></span>\n                  </>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Live status */}\n      {biddingAddress && (\n        <div className=\"component-card\">\n          <div className=\"component-header\">\n            <h2>Live Bidding Status</h2>\n          </div>\n          <div className=\"component-body\">\n            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\n              <div>\n                <div style={{ fontSize: '12px', color: '#718096' }}>Bidding Contract</div>\n                <div style={{ fontWeight: '600' }}>{biddingAddress}</div>\n              </div>\n              <div>\n                <div style={{ fontSize: '12px', color: '#718096' }}>Current Winner</div>\n                <div style={{ fontWeight: '600' }}>{winner || '-'}</div>\n                <div style={{ fontSize: '12px', color: '#718096' }}>Winning Amount</div>\n                <div style={{ fontWeight: '600' }}>{winningAmount || '-'}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Commit */}\n      <div className=\"component-card\">\n        <div className=\"component-header\">\n          <h2>Commit Bid</h2>\n        </div>\n        <div className=\"component-body\">\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Amount (uint256)</label>\n              <input className=\"form-input\" type=\"number\" value={commitAmount} onChange={(e) => setCommitAmount(e.target.value)} placeholder=\"e.g. 100\" />\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Salt (bytes32 hex)</label>\n              <div style={{ display: 'flex', gap: '8px' }}>\n                <input className=\"form-input\" type=\"text\" value={saltHex} onChange={(e) => setSaltHex(e.target.value)} placeholder=\"0x...32 bytes\" />\n                <button className=\"btn btn-secondary\" onClick={generateSalt}>Random</button>\n              </div>\n            </div>\n          </div>\n          {commitHash && (\n            <div style={{ marginTop: '10px', color: '#718096' }}>Commit hash: <code>{commitHash}</code></div>\n          )}\n          <div style={{ marginTop: '12px' }}>\n            <button className=\"btn btn-primary\" onClick={handleCommit} disabled={!selectedGroup || !commitAmount || !saltHex}>Submit Commit</button>\n          </div>\n        </div>\n      </div>\n\n      {/* Reveal */}\n      <div className=\"component-card\">\n        <div className=\"component-header\">\n          <h2>Reveal Bid</h2>\n        </div>\n        <div className=\"component-body\">\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Amount (uint256)</label>\n              <input className=\"form-input\" type=\"number\" value={revealAmount} onChange={(e) => setRevealAmount(e.target.value)} placeholder=\"Must match commit\" />\n            </div>\n            <div className=\"form-group\">\n              <label className=\"form-label\">Salt (bytes32 hex)</label>\n              <input className=\"form-input\" type=\"text\" value={revealSalt} onChange={(e) => setRevealSalt(e.target.value)} placeholder=\"Must match commit\" />\n            </div>\n          </div>\n          <div style={{ marginTop: '12px' }}>\n            <button className=\"btn btn-primary\" onClick={handleReveal} disabled={!selectedGroup || !revealAmount || !revealSalt}>Submit Reveal</button>\n          </div>\n        </div>\n      </div>\n\n      <div style={{ marginTop: '10px' }}>\n        {status && <div style={{ color: '#2f855a' }}>{status}</div>}\n        {error && <div style={{ color: '#c53030' }}>{error}</div>}\n      </div>\n        </div>\n        <div>\n          <div className=\"component-card\" style={{ position: 'sticky', top: '100px' }}>\n            <div className=\"component-header\">\n              <h2>Bidding History</h2>\n            </div>\n            <div className=\"component-body\">\n              {!selectedGroup ? (\n                <div style={{ color: '#718096' }}>Select a group to view history.</div>\n              ) : reveals.length === 0 ? (\n                <div style={{ color: '#718096' }}>No reveals yet.</div>\n              ) : (\n                <div style={{ display: 'grid', gap: '12px' }}>\n                  {reveals.map((r, idx) => (\n                    <div key={idx} style={{ border: '1px solid #e2e8f0', borderRadius: '12px', padding: '16px', display: 'grid', gridTemplateColumns: '1fr auto', alignItems: 'center' }}>\n                      <div>\n                        <div style={{ fontWeight: 600, fontSize: '16px' }}>{shortAddr(r.bidder)}</div>\n                        <div style={{ color: '#718096', fontSize: '14px' }}>{r.at ? new Date(r.at).toLocaleTimeString() : ''}</div>\n                      </div>\n                      <div style={{ color: '#e53e3e', fontWeight: 700, fontSize: '20px' }}>{formatTokens(r.amount)} tokens</div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default BiddingInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}